<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Python Generators &middot; André Almar</title>

  
  <link rel="stylesheet" href="http://andrealmar.com/css/poole.css">
  <link rel="stylesheet" href="http://andrealmar.com/css/hyde.css">
  <link rel="stylesheet" href="http://andrealmar.com/css/poole-overrides.css">
  <link rel="stylesheet" href="http://andrealmar.com/css/hyde-overrides.css">
  <link rel="stylesheet" href="http://andrealmar.com/css/hyde-x.css">
  <link rel="stylesheet" href="http://andrealmar.com/css/highlight/sunburst.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://andrealmar.com/touch-icon-144-precomposed.png">
  <link href="http://andrealmar.com/favicon.png" rel="icon">

  
  
  
  

  <meta name="description" content="I am a software developer trying to change the world one line-of-code at a time.">
  <meta name="keywords" content="andre,almar,andre almar,developer,engineer,web application,python,golang,javascript,html,docker,devops,entrepreneurship, web development">
  
</head>
<body class="theme-base-4b">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1>André Almar</h1>
      <p class="lead">Trying to change the world one line-of-code at a time.</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="http://andrealmar.com/">Home</a></li>
      <li class="sidebar-nav-item"><a href="http://andrealmar.com/about">About</a></li>
      <li class="sidebar-nav-item"><a href="http://andrealmar.com/talks">Talks</a></li>
      <li class="sidebar-nav-item"><a href="http://andrealmar.com/projects">Projects</a></li>
      <li class="sidebar-nav-item"><a href="mailto:andre@pydevv.com?Subject=Contact%20via%20website">Contact</a></li>
      <li class="sidebar-nav-item"><a href="http://andrealmar.com/download/andre-araujo-cv.pdf">Resume</a></li>


      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/andrealmar"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      
      <a href="https://plus.google.com/&#43;AndreAraujo04"><i class="fa fa-google-plus-square fa-3x"></i></a>
      <a href="https://facebook.com/andrealmar"><i class="fa fa-facebook-square fa-3x"></i></a>
      <a href="https://twitter.com/andre_almar"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      
      </li>
    </ul>

    

    <p>&copy; 2016 Andre Almar<br/>
    All Rights Reserved <br />Creative Commons License<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Contract Creative Commons" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a></p>
  </div>
</div>


<div class="content container">
  <div class="post">
    <h1>Python Generators</h1>
    <span class="post-date">Feb 4, 2016 &middot; 4 minute read &middot; <a href="http://andrealmar.com/2016/02/generators/#disqus_thread">Comments</a>
    
    <br/>
    <a class="label" href="http://andrealmar.com/categories/python">python</a>
    </span>
    <blockquote>
<p>I&rsquo;m the Generator, firing whenever you quit
<br/>
Yeah whatever it is, you go out and it&rsquo;s on
<br/>
Yeah can&rsquo;t you hear my motored heart
<br/>
You&rsquo;re the one that started it</p>
</blockquote>

<p><br />
<img src="/images/Generator_FooFighters.jpg">
<br /><br />
Não&hellip;eu não vou escrever neste post sobre a ótima música do Foo Fighters (embora recomendo que você a escute =P). Estamos aqui para falar de uma função bastante legal na nossa linguagem de programação preferida: Os famosos <strong>Generators</strong>.
<br /><br />
Em termo simples os <strong>Generators</strong> são <em>funções que permitem a você declarar uma função que se comporta como um iterador, ou seja, que pode ser usado dentro de um loop</em> <strong>for</strong>.<br />
<br />
Simplificando mais ainda: <strong>Generators</strong> são uma forma simples de criarmos iteradores.  Ele irá retornar um objeto (iterador) para que nós possamos iterar sobre este objeto (um valor de cada vez).<br />
<br />
É muito simples criar uma função <strong>Generator</strong>, mas existem algumas peculiaridades. Por exemplo, nós usamos a declaração <strong>yield</strong> ao invés de <strong>return</strong>. Se a função contém ao menos uma declaração <strong>yield</strong> então ela se torna uma função <strong>Generator</strong>.
<br /><br />
Um exemplo bem simples. Abra o seu interpretador Python e digite a função abaixo:
<br /></p>

<pre><code class="language-python">def generator():
    n = 1
    print(&quot;Essa  uma função Generator&quot;)
    yield n

    n += 1
    yield n

    n += 1
    yield n

</code></pre>

<p>Vamos agora, executar a função no interpretador Python:</p>

<pre><code class="language-python">&gt;&gt;&gt; # Retorna um objeto mas não executa a função imediatamente.
&gt;&gt;&gt; a = generator()

&gt;&gt;&gt; # Podemos iterar sobre os items usando next().
&gt;&gt;&gt; next(a)
Essa  uma função Generator
1
&gt;&gt;&gt; # Assim que a função executa o yield, ela é pausada e o controle da execução é transferido para quem a chamou.

&gt;&gt;&gt; # Variáveis locais e os seus estados são &quot;lembradas&quot; durante as sucessivas chamadas à função.
&gt;&gt;&gt; next(a)
2
&gt;&gt;&gt; next(a)
3

&gt;&gt;&gt; # Quando a função termina, a exceção StopIteration é levantada automaticamente.
&gt;&gt;&gt; next(a)
Traceback (most recent call last):
...
StopIteration
&gt;&gt;&gt; next(a)
Traceback (most recent call last):
...
StopIteration

</code></pre>

<p>Interessante notar que o valor da variável <em>a</em> no exemplo acima é lembrada durante cada chamada do método <em>next()</em>. Nós declaramos 3 <strong>yields</strong>, então o valor da variável <em>a</em> será lembrado por 3 vezes. Quando tentamos chamar <em>next(a)</em> pela 4a vez, veja o que acontece:</p>

<pre><code class="language-python">&gt;&gt;&gt; # Quando a função termina, a exceção StopIteration é levantada automaticamente.
&gt;&gt;&gt; next(a)
Traceback (most recent call last):
...
StopIteration
&gt;&gt;&gt; next(a)
Traceback (most recent call last):
...
StopIteration

</code></pre>

<p>Uma exceção <em>StopIteration</em> é lançada, alertando que a iteração acabou. Ou seja, as variáveis locais NÃO são destruídas quando usamos o <strong>yield</strong>. O objeto <strong>Generator</strong> só pode ser iterado uma única vez. Se quisermos restartar o processo nós precisaremos criar um outro objeto <strong>Generator</strong>, por exemplo <em>b = generator()</em>.
<br /><br />
Também podemos utilizar <strong>Generators</strong> dentro de um laço <strong>for</strong> diretamente. Isso porque o laço <strong>for</strong> também utiliza a função <em>next()</em> para iterar e automaticamente encerra a iteração quando a exceção <em>StopIteration</em> é lançada.</p>

<pre><code class="language-python">&gt;&gt;&gt; for item in generator():
...     print(item)
...
Essa é uma função Generator
1
2
3
&gt;&gt;
</code></pre>

<p><strong>Generators Expressions</strong>
<br /><br />
As <strong>Generators Expressions</strong> facilitam à criação de <strong>Generators</strong>. Assim como uma função lambda cria uma função anônima, uma <strong>Generator Expression</strong> cria uma função <strong>Generator</strong> anônima. A sintaxe é bem parecida com as famosas <em>List Comprehensions</em> com o pequeno detalhe de que os colchetes [ ] são subsituídos pelos parênteses ( ).</p>

<pre><code class="language-python">list_comprehension = [1,2,3,4,5,6,7,8]
</code></pre>

<pre><code class="language-python">generator_expression = (1,2,3,4,5,6,7,8)
</code></pre>

<pre><code class="language-python">&gt;&gt;&gt; x = [1, 2, 3, 4, 5, 6, 6, 8]
&gt;&gt;&gt; x
[1, 2, 3, 4, 5, 6, 6, 8]
&gt;&gt;&gt; generator_expression = (i for i in x)
&gt;&gt;&gt; generator_expression
&lt;generator object &lt;genexpr&gt; at 0x101812af0&gt;
&gt;&gt;&gt; list_comprehension = [i for i in x]
&gt;&gt;&gt; list_comprehension
[1, 2, 3, 4, 5, 6, 6, 8]
&gt;&gt;&gt; 
</code></pre>

<p>Note no exemplo acima que a <strong>List Comprehension</strong> nos retorna a lista em si mas a <strong>Generator Expression</strong> nos retorna o objeto gerado:
<code>&lt;generator object &lt;genexpr&gt; at 0x101812af0&gt;</code>.<br />
<br />
A outra vantagem é que enquanto a <em>List Comprehension</em> gera a lista inteira, a <strong>Generator Expression</strong> gera um item de cada vez. Isso também é chamado de <em>lazy ou on demand generation of values</em>. E por consequência de ser <em>lazy</em> (preguiçosa), a <strong>Generator Expression</strong> consome bem menos memória sendo mais eficiente do que uma <em>List Comprehension</em>.<br />
<br />
Espero que tenham gostado dessa explicação a respeito dos <strong>Generators</strong> e quaisquer dúvidas deixem seus comentários abaixo.<br />
<br />
{}&rsquo;s</p>

  </div>
  <div id="disqus_thread"></div>
</div>


<script type="text/javascript">
var disqus_shortname = "andrealmar";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



<script type="text/javascript">
    var disqus_shortname = "andrealmar";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script src="http://andrealmar.com/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-58773330-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>

